<!doctype html>
<html lang="en">
    <head>
		<meta charset="UTF-8">

		<link rel="stylesheet" href="jqtouch/jqtouch.css" type="text/css" media="screen" charset="utf-8">
		<link rel="stylesheet" href="themes/apple/theme.css" type="text/css" media="screen" charset="utf-8">
		<link rel="stylesheet" href="css/sakai.mobile.css" type="text/css" media="screen" charset="utf-8">

		<script src="jqtouch/jquery-1.4.2.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="jqtouch/jqtouch.js" type="text/javascript" charset="utf-8"></script>
        

		<script type="text/javascript">
			var jQT = new $.jQTouch({
				icon: 'images/mobile_icon.png',
				addGlossToIcon: false,
				startupScreen: 'images/mobile_startup.png',
				statusBar: 'black',
				formSelector: false,
				useFastTouch: false/*,
				preloadImages: [
					'themes/apple/img/back_button.png',
					'themes/apple/img/back_button_clicked.png',
					'themes/apple/img/button_clicked.png',
					'themes/apple/img/grayButton.png',
					'themes/apple/img/whiteButton.png',
					'themes/apple/img/loading.gif'
				]*/
			});
			
			$(function(){
				
				var disabledButtonClass = "disabledButton";
				var $sakai3_username = $("#sakai3_username");
				var $sakai3_password = $("#sakai3_password");
				var $sakai3_signin = $("#sakai3_signin");
				var $sakai3_signin_button = $("#sakai3_signin_button");

				var enableDisableSignin = function(){
					if($sakai3_username.val() && $sakai3_password.val()){
						$sakai3_signin_button.removeClass(disabledButtonClass);
					}else{
						$sakai3_signin_button.addClass(disabledButtonClass);
					}
				};

				$sakai3_password.bind("keydown", enableDisableSignin);
				$sakai3_username.bind("keydown", enableDisableSignin);
				
				var checkSigninSuccess = function(data, success){
					if(success){
						
					}
				};
				
				var performSignin = function(){

					//if(!areSigninFieldsEmpty){
						var data = {
							"sakaiauth:login" : 1,
							"sakaiauth:un" : $sakai3_username.val(),
							"sakaiauth:pw" : $sakai3_password.val(),
							"_charset_":"utf-8"
						};

				        $.ajax({
				            url : "/system/sling/formlogin",
				            type : "POST",
				            success : function(){
								checkSigninSuccess(data, true);
							},
				            error : function(){
								checkSigninSuccess(data, false);
							},
				            data : data
				        });

				        return false;
					//}

				}
				
				$sakai3_signin.submit(function(){
					performSignin();
				});
			});
		</script>
        <title>Sakai3 mobile</title>
    </head>
    <body>
        <div id="jqt">
			<div id="signin" class="current">
				<div class="toolbar">
                    <h1>Sign In</h1>
                </div>
				<div id="sakai3_logo">
					<img src="images/mobile_logo.png" width="136" height="62" alt="Mobile Logo">
				</div>
				<form id="sakai3_signin" action="/system/sling/formlogin" method="POST" class="form">
					<ul class="rounded">
						<li>
							<input id="sakai3_username" type="text" placeholder="Username" />
						</li>
						<li>
							<input id="sakai3_password" type="password" placeholder="Password" />
						</li>
					</ul>
					<a id="sakai3_signin_button" href="#" class="submit sakai3_button whiteButton disabledButton">Sign In</a>
				</form>
			</div>
		</div>
    </body>
</html>